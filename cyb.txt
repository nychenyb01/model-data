The business logic of this process can be summarized in the following steps:

1. Load Core Data

· The main list of assigned accounts is loaded from "assignment list250619-250731.xlsx".
· A separate historical assignment list is loaded to find the first assignment date for each account.

2. Identify Agent Type for Calls

· A list of call records is loaded. For each call, the system identifies whether the agent was onshore or offshore by checking their ID against separate staff lists.

3. Flag Target Offshore Calls
The process identifies potential target calls that meet all of these conditions:

· The call is an Outbound Call (OC).
· The agent who made the call is an offshore agent.
· The call date is after the account's first assignment date.

4. Apply Inbound Call (IC) Precedence Rule

· For each account and date, the system identifies the earliest inbound (IC) and earliest outbound (OC) call times.
· If an inbound call (IC) occurred before the outbound call (OC) on the same day, that specific OC call is excluded from the final exception list. The logic is that the customer made contact first.

5. Final Filtering

· From the remaining list, a final check is performed: if the date of any subsequent inbound call (IC) is later than the date of the flagged outbound call (OC), it is marked separately (IC_Date_After_OC_Date = "Y").
· The final output is filtered to include only records where the call type is "OC".

6. Generate Output
The final list of flagged outbound calls made by offshore agents is saved to the file: "A&A output strategy 19.xlsx".